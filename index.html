<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Editor</title>
</head>

<body>
    <h1>Edit JSON Fields</h1>
    <div>
        <label for="field">Field Name:</label>
        <input type="text" id="field" placeholder="Enter field name">
    </div>
    <div>
        <label for="value">Field Value:</label>
        <input type="text" id="value" placeholder="Enter field value">
    </div>
    <button onclick="updateJSON()">Update JSON</button>
    <div>
        <h2>Current JSON:</h2>
        <pre id="currentJSON"></pre>
    </div>

    <script>
        const githubUsername = 'honorsystem';
        const repositoryName = 'honorsystem';
        const jsonFileName = 'data.json';

        async function updateJSON() {
            const field = document.getElementById('field').value;
            const value = document.getElementById('value').value;

            if (!field || !value) {
                alert('Field name and value are required.');
                return;
            }

            try {
                const response = await fetch(`https://api.github.com/repos/${githubUsername}/${repositoryName}/contents/${jsonFileName}`);
                const jsonFile = await response.json();
                const jsonContent = JSON.parse(atob(jsonFile.content));
                jsonContent[field] = value;

                const updateData = {
                    message: `Update ${field} field via JSON Editor`,
                    content: btoa(JSON.stringify(jsonContent, null, 2)),
                    sha: jsonFile.sha
                };

                await fetch(`https://api.github.com/repos/${githubUsername}/${repositoryName}/contents/${jsonFileName}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': 'Bearer YOUR_GITHUB_TOKEN', // Replace with your GitHub personal access token
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updateData)
                });

                alert('JSON updated successfully!');
                displayCurrentJSON();
            } catch (error) {
                console.error('Error updating JSON:', error);
                alert('An error occurred while updating JSON.');
            }
        }

        async function displayCurrentJSON() {
            try {
                const response = await fetch(`https://raw.githubusercontent.com/${githubUsername}/${repositoryName}/main/${jsonFileName}`);
                const jsonContent = await response.text();
                document.getElementById('currentJSON').textContent = jsonContent;
            } catch (error) {
                console.error('Error fetching JSON:', error);
                document.getElementById('currentJSON').textContent = 'Error fetching JSON.';
            }
        }

        // Initial display
        displayCurrentJSON();
    </script>
</body>

</html>
